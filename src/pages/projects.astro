---
import Layout from '../layouts/Layout.astro';
import Header from '../components/layout/Header.astro';
import Footer from '../components/layout/Footer.astro';
import ProjectCard from '../components/ui/ProjectCard.astro';
import { getCollection } from 'astro:content';

const allProjects = await getCollection('projects');
const categories = [...new Set(allProjects.map(project => project.data.category))];
const statuses = [...new Set(allProjects.map(project => project.data.status))];
---

<Layout 
  title="Our Projects - Ther-AI"
  description="Explore our cutting-edge AI healthcare projects that are transforming medical diagnosis, treatment, and patient care worldwide."
>
  <Header />
  <main>
    <!-- Hero Section -->
    <section class="bg-gradient-to-br from-[#0D0B26] via-[#1a1640] to-[#0D0B26] light:from-gray-50 light:to-blue-50 py-20">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
        <h1 class="text-4xl md:text-5xl font-bold text-white light:text-gray-900 mb-6">
          Our AI Healthcare Projects
        </h1>
        <p class="text-xl text-gray-300 light:text-gray-600 max-w-3xl mx-auto">
          Cutting-edge research and development projects that are transforming the future 
          of healthcare through artificial intelligence.
        </p>
      </div>
    </section>
    
    <!-- Filters -->
    <section class="py-8 bg-white/5 light:bg-white border-b border-white/10 light:border-gray-200">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="space-y-4">
          <!-- Category Filters -->
          <div>
            <h3 class="text-sm font-medium text-gray-300 light:text-gray-700 mb-3">Categories:</h3>
            <div class="flex flex-wrap gap-3">
              <button class="px-4 py-2 bg-blue-600 text-white rounded-lg font-medium category-filter active" data-filter="all">
                All Categories
              </button>
              {categories.map((category) => (
                <button class="px-4 py-2 bg-white/10 light:bg-gray-100 text-gray-300 light:text-gray-700 rounded-lg font-medium hover:bg-white/20 light:hover:bg-gray-200 transition-colors duration-200 category-filter" data-filter={category}>
                  {category}
                </button>
              ))}
            </div>
          </div>
          
          <!-- Status Filters -->
          <div>
            <h3 class="text-sm font-medium text-gray-300 light:text-gray-700 mb-3">Status:</h3>
            <div class="flex flex-wrap gap-3">
              <button class="px-4 py-2 bg-green-600 text-white rounded-lg font-medium status-filter active" data-filter="all">
                All Status
              </button>
              {statuses.map((status) => (
                <button class="px-4 py-2 bg-white/10 light:bg-gray-100 text-gray-300 light:text-gray-700 rounded-lg font-medium hover:bg-white/20 light:hover:bg-gray-200 transition-colors duration-200 status-filter" data-filter={status}>
                  {status.charAt(0).toUpperCase() + status.slice(1).replace('-', ' ')}
                </button>
              ))}
            </div>
          </div>
        </div>
      </div>
    </section>
    
    <!-- Projects Grid -->
    <section class="py-20 bg-[#0D0B26] light:bg-gray-50">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8" id="projects-grid">
          {allProjects.map((project) => (
            <div class="project-item animate-fade-in" data-category={project.data.category} data-status={project.data.status}>
              <ProjectCard 
                title={project.data.title}
                description={project.data.description}
                category={project.data.category}
                status={project.data.status}
                technologies={project.data.technologies}
                images={project.data.images}
                results={project.data.results}
                slug={project.slug}
              />
            </div>
          ))}
        </div>
      </div>
    </section>
  </main>
  <Footer />
</Layout>

<script>
  // Project filtering functionality
  document.addEventListener('DOMContentLoaded', () => {
    const categoryFilters = document.querySelectorAll('.category-filter');
    const statusFilters = document.querySelectorAll('.status-filter');
    const projectItems = document.querySelectorAll('.project-item');
    
    let activeCategory = 'all';
    let activeStatus = 'all';
    
    function filterProjects() {
      projectItems.forEach(item => {
        const category = item.getAttribute('data-category');
        const status = item.getAttribute('data-status');
        
        const categoryMatch = activeCategory === 'all' || category === activeCategory;
        const statusMatch = activeStatus === 'all' || status === activeStatus;
        
        if (categoryMatch && statusMatch) {
          item.style.display = 'block';
        } else {
          item.style.display = 'none';
        }
      });
    }
    
    categoryFilters.forEach(button => {
      button.addEventListener('click', () => {
        activeCategory = button.getAttribute('data-filter');
        
        categoryFilters.forEach(btn => {
          btn.classList.remove('active', 'bg-blue-600', 'text-white');
          btn.classList.add('bg-white/10', 'light:bg-gray-100', 'text-gray-300', 'light:text-gray-700');
        });
        button.classList.add('active', 'bg-blue-600', 'text-white');
        button.classList.remove('bg-white/10', 'light:bg-gray-100', 'text-gray-300', 'light:text-gray-700');
        
        filterProjects();
      });
    });
    
    statusFilters.forEach(button => {
      button.addEventListener('click', () => {
        activeStatus = button.getAttribute('data-filter');
        
        statusFilters.forEach(btn => {
          btn.classList.remove('active', 'bg-green-600', 'text-white');
          btn.classList.add('bg-white/10', 'light:bg-gray-100', 'text-gray-300', 'light:text-gray-700');
        });
        button.classList.add('active', 'bg-green-600', 'text-white');
        button.classList.remove('bg-white/10', 'light:bg-gray-100', 'text-gray-300', 'light:text-gray-700');
        
        filterProjects();
      });
    });
  });
</script>